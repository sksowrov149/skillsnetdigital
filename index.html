<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillsNet Digital - Auto Admin</title>
    <style>
        :root { --primary: #1a2a6c; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; }
        .navbar { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: bold; font-size: 22px; }
        .container { background: white; width: 92%; max-width: 450px; margin: 20px auto; padding: 25px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.15); }
        .page, .step { display: none; }
        .active { display: block !important; }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; }
        
        /* এডমিন টেবিল */
        .admin-section { padding: 15px; background: white; min-height: 100vh; display: none; }
        table { width: 100%; border-collapse: collapse; background: white; font-size: 13px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: var(--primary); color: white; }
        .manage-btn { background: #ffc107; color: black; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: bold; }
        
        /* ডাইনামিক এডিট বক্স */
        #editModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:999; padding: 20px; box-sizing: border-box; color: white; overflow-y: auto; }
        .field-group { margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .field-label { display: block; color: #aaa; font-size: 12px; text-transform: uppercase; }
    </style>
</head>
<body>

<div id="ui-wrapper">
    <div class="navbar">SkillsNet Digital</div>
    <div class="container" id="mainApp">
        <div id="loginPage" class="page active">
            <h2 style="text-align:center;">Login</h2>
            <input type="number" id="lPhone" placeholder="Phone Number">
            <input type="password" id="lPass" placeholder="Password">
            <button onclick="doLogin()">Login</button>
            <p style="text-align:center;">নতুন? <span style="color:blue;cursor:pointer" onclick="showPage('regPage')">Sign-up</span></p>
            <p style="text-align:center;margin-top:40px;"><span style="color:#ddd;cursor:pointer;font-size:11px;" onclick="showPage('adminLogin')">Admin Panel</span></p>
        </div>

        <div id="regPage" class="page">
            <h3>Registration</h3>
            <input type="text" id="regName" placeholder="Full Name">
            <input type="number" id="regPhone" placeholder="Phone Number">
            <input type="email" id="regEmail" placeholder="Email Address">
            <input type="password" id="regPass" placeholder="Set Password">
            <button onclick="saveUser()">Register Now</button>
            <button style="background:gray" onclick="showPage('loginPage')">Back</button>
        </div>

        <div id="dashboard" class="page">
            <h3 id="welcomeTxt"></h3>
            <div style="padding:20px; background:#f9f9f9; border-radius:10px; text-align:center;">আপনার অ্যাকাউন্ট সক্রিয় আছে।</div>
            <button onclick="location.reload()" style="background:#d9534f">Logout</button>
        </div>

        <div id="adminLogin" class="page">
            <h3>Admin Access</h3>
            <input type="text" id="adUser" placeholder="Admin Username">
            <input type="password" id="adPass" placeholder="Admin Password">
            <button onclick="verifyAdmin()">Login Admin</button>
            <button style="background:gray" onclick="showPage('loginPage')">Back</button>
        </div>
    </div>
</div>

<div id="adminPanel" class="admin-section">
    <h2 style="text-align:center; color:var(--primary);">Master Database</h2>
    <div style="overflow-x:auto;">
        <table>
            <thead><tr><th>ID</th><th>Name</th><th>Phone</th><th>Control</th></tr></thead>
            <tbody id="masterTable"></tbody>
        </table>
    </div>
    <button onclick="location.reload()" style="background:#333; margin-top:20px;">Exit Admin Panel</button>
</div>

<div id="editModal">
    <h2 style="color:#ffc107">User Data Manager</h2>
    <p>ইউজারের যেকোনো তথ্য এখান থেকে পরিবর্তন করুন।</p>
    <div id="dynamicInputs"></div>
    <div style="margin-top:20px;">
        <button style="background:#28a745" onclick="saveMasterData()">Save All Changes</button>
        <button style="background:#666; margin-top:10px;" onclick="closeModal()">Cancel</button>
    </div>
</div>

<script>
    let users = JSON.parse(localStorage.getItem('SND_USERS')) || [];
    let currentIdx = null;

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function saveUser() {
        let newUser = {
            uid: "SND" + Math.floor(1000 + Math.random() * 9000),
            name: document.getElementById('regName').value,
            phone: document.getElementById('regPhone').value,
            email: document.getElementById('regEmail').value,
            pass: document.getElementById('regPass').value,
            status: "Active",
            balance: "0.00", // উদাহরণ: পরে আপনি যা যোগ করবেন
            join_date: new Date().toLocaleDateString()
        };
        users.push(newUser);
        localStorage.setItem('SND_USERS', JSON.stringify(users));
        alert("Registration Success! ID: " + newUser.uid);
        location.reload();
    }

    function doLogin() {
        let u = users.find(x => x.phone === document.getElementById('lPhone').value && x.pass === document.getElementById('lPass').value);
        if(u) { showPage('dashboard'); document.getElementById('welcomeTxt').innerText = "স্বাগতম, " + u.name; }
        else alert("Login Failed!");
    }

    function verifyAdmin() {
        if(document.getElementById('adUser').value==='admin' && document.getElementById('adPass').value==='1234') {
            document.getElementById('ui-wrapper').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            renderTable();
        } else alert("Invalid Admin!");
    }

    function renderTable() {
        let rows = '';
        users.forEach((u, i) => {
            rows += `<tr>
                <td>${u.uid}</td>
                <td>${u.name}</td>
                <td>${u.phone}</td>
                <td><button class="manage-btn" onclick="openManager(${i})">Manage</button></td>
            </tr>`;
        });
        document.getElementById('masterTable').innerHTML = rows;
    }

    function openManager(index) {
        currentIdx = index;
        let user = users[index];
        let modalBody = document.getElementById('dynamicInputs');
        modalBody.innerHTML = '';

        // ম্যাজিক পার্ট: ইউজারের সব প্রপার্টি অটো লুপ করে ইনপুট তৈরি করবে
        Object.keys(user).forEach(key => {
            modalBody.innerHTML += `
                <div class="field-group">
                    <label class="field-label">${key.replace('_',' ')}</label>
                    <input type="text" id="master_${key}" value="${user[key]}" style="background:#222; color:white; border:1px solid #444;">
                </div>`;
        });
        document.getElementById('editModal').style.display = 'block';
    }

    function saveMasterData() {
        let user = users[currentIdx];
        Object.keys(user).forEach(key => {
            user[key] = document.getElementById('master_' + key).value;
        });
        localStorage.setItem('SND_USERS', JSON.stringify(users));
        alert("ইউজারের সব তথ্য সফলভাবে আপডেট হয়েছে!");
        closeModal();
        renderTable();
    }

    function closeModal() { document.getElementById('editModal').style.display = 'none'; }
</script>

</body>
</html>

